---
layout: post
title: Setup OpenCV for Python in Windows
categories:
- OpenCV
tags:
- OpenCV
- Python
status: publish
type: post
published: true
---
<p>I have always struggled when trying to set up OpenCV for Python before. So I decide to write this post to help myself in the future and share with you =). My setup is for OpenCV 2.2 but I think you can apply for any version of OpenCV.<br />
<!--more--><br />
<strong>Step 1:</strong> Download and install <strong>Python 2.7</strong> from&nbsp;<a href="http://www.python.org/getit/releases/2.7.2/">http://www.python.org/getit/releases/2.7.2/</a>. You need to install the <strong>32bit version</strong> of Python. OpenCV currently does not work with Python 64bit.</p>
<p><strong>Step 2:</strong> Download and install <strong>OpenCV 2.2</strong> from&nbsp;<a href="http://sourceforge.net/projects/opencvlibrary/files/">http://sourceforge.net/projects/opencvlibrary/files/</a>. Note that this version only supports Python 2.7 (not 3.x).</p>
<p><strong>Step 3:</strong> Download and install <strong>NumPy 1.6.1</strong> and <strong>SciPy 0.9.0</strong> from:&nbsp;(you need to&nbsp;choose the files which support Python 2.7)</p>
<ul>
<li><a href="http://sourceforge.net/projects/numpy/files/NumPy/1.6.1/" target="_blank">http://sourceforge.net/projects/numpy/files/NumPy/1.6.1/</a></li>
<li><a href="http://sourceforge.net/projects/scipy/files/scipy/0.9.0/" target="_blank">http://sourceforge.net/projects/scipy/files/scipy/0.9.0/</a></li>
</ul>
<p><strong>Step 4:</strong>Setup Windows Path in Environment Variables</p>
<ul>
<li>Add "<em><strong>C:/Python2.7;C:/OpenCV2.2/bin</strong></em>" to PATH variable (You need to change the directory to where you install Python and OpenCV).</li>
<li>Create PYTHONPATH variable and put "<em><strong>C:/OpenCV2.2/Python2.7/Lib/site-packages</strong></em>" as value.</li>
</ul>
<p><strong>Update:</strong> For OpenCV2.3, There are two other options for this step:</p>
<ul>
<li>As Kyle commented <a href="http://luugiathuy.com/2011/02/setup-opencv-for-python/#comment-62">below</a>, you can copy the content of folder "<strong>C:opencvbuildpython2.7</strong>" (for opencv 2.2: C:/OpenCV2.2/Python2.7/Lib/site-packages) to folder "<strong>C:Python27Libsite-packages</strong>"</li>
<li><strong>OR</strong>, add these two lines at the beginning of your program:
<pre lang="python">
import sys
sys.path.append("C:OpenCV2.2Python2.7Libsite-packages")
</pre>
</li>
</ul>
</li>
</ul>
<p>Yosh!!! You have finished setup OpenCV for Python in Windows. Open Python IDLE,&nbsp;create a new file, add the program below and run it:</p>
<pre lang="python">
import cv

cv.NamedWindow(&quot;camera&quot;, 1)
capture = cv.CaptureFromCAM(0)

while True:
    img = cv.QueryFrame(capture)
    cv.ShowImage("camera", img)
    if cv.WaitKey(10) == 27:
        break
cv.DestroyWindow("camera")
</pre>
<p>(This is the program to show your webcam)</p>
<p><strong>UPDATE</strong>:</p>
<ol>
<li>OpenCV has just released version 2.3.1 which is more stable than 2.2 I think. You can download it <a href="http://sourceforge.net/projects/opencvlibrary/files/opencv-win/2.3.1/">here</a> and try it (the setup is same as 2.2).</li>
<li>About the black screen you encounter with the example, I think it's because your camera is not supported. My camera works fine. You can find more information <a href="http://stackoverflow.com/questions/7247475/opencv-2-3-c-qtgui-problem-initializing-some-specific-usb-devices-and-setups" target="_blank">here</a>.</li>
</ol>
